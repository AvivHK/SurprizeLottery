<!DOCTYPE html>
<html lang="en">

<head>
    <script src="https://kit.fontawesome.com/519f39c2f0.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="style.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">
    <link href="https://fonts.googleapis.com/css?family=Odibee+Sans&display=swap" rel="stylesheet">
    <title>SurprizeLottery</title>
</head>

<body>
    <script src="https://www.paypal.com/sdk/js?client-id=sb&currency=USD"
        data-sdk-integration-source="button-factory"></script>

    <div id="header">

        <nav role="navigation">
            <div id="menuToggle">

                <input type="checkbox">

                <span></span>
                <span></span>
                <span></span>

                <ul id="menu">
                    <li class="goHome">Home</li>
                    <li class="goMoney">Money Lotteries</li>
                    <li class="goProduct">Product Lotteries</li>
                    <li class="goWinner">Winners List</li>
                </ul>
            </div>
        </nav>

        <h1 id="siteName" class="goHome">Surprize Lottery</h1>
    </div>

    <div id="container"></div>

    <script id="lotteryTemplate" type="text/x-handlebars-template">
        {{#each lotteryData}}
          <div class="card" data-id={{_id}}>
                {{#if isProduct}}
                    <div class="prize">
                        <img  src="{{productPic}}" alt="{{productPrize}}">
                    </div>
                    <div class="type">
                        <h3 >{{productPrize}}</h3>
                    </div>
                {{/if}}
                {{#unless isProduct}}
                    <div class="prize">
                        <h1>{{moneyPrize}} DOLLARS</h1>
                    </div>
                    <div class="type">
                        <h3 >{{moneyPrize}}$</h3>
                    </div>
                {{/unless}}
                <div class="lotteryInfo">
                    <div class="participants">Odds: 1/{{users.length}} </div>
                    <div class="needToChange"></div>
                    <div class="dueDate">{{dueDate}}</div>
                </div>
                <div class="paymentBox">
                <div class="buyIn">{{entryFee}}$ per ticket</div>
                </div>
            </div>
        {{/each}}
    </script>

    <script id="winnersTemplate" type="text/x-handlebars-template">
        <h3 class="winnerListHeader">Winner-List</h3>
                <div class="winnerList">
                     <ul>
                         {{#each winnerData}}
                              <li>{{firstName}} {{lastName}} won {{#if moneyPrize}}{{moneyPrize}}${{/if}}{{#if productPrize}}{{productPrize}} <img class="winnerpic" src="{{productPic}}" alt="productPic"> {{/if}} </li>
                          {{/each}}
                     </ul>
               </div>
          </script>

    <div id="popUpCard">
        <div id="popupContact">
            <form id="form">
                <div id="close" onclick="div_hide()">X</div>
                <div id="popUpContainer"></div>
            </form>
        </div>
    </div>

    <script>
        function closeForm() {
            document.getElementById("myForm").style.display = "none";
        }
    </script>

    <script id="popUpTemplate" type="text/x-handlebars-template">
        <div class="popUpCard" data-id={{_id}}>
            {{#if isProduct}}
                <div class="popUpPrize">
                    <img class="popUpImage" src="{{productPic}}" alt="{{productPrize}}">
                </div>
                <div class="popUpType">
                    <h3 class="popUpProductPrize">{{productPrize}}</h3>
                    <h3 class="popUpProductDescription">{{productDescription}}</h3>
                </div>
            {{/if}}
            {{#unless isProduct}}
                <div class="popUpPrize">
                    <h1 class="popUpMoneyPrize">{{moneyPrize}}$ DOLLARS</h1>
                </div>
                <div class="popUpType">
                    <h3>Make your money NOW!</h3>
                </div>
            {{/unless}}
            <div class="popUpLotteryInfo">
                <div class="popUpParticipants">Participants: {{users.length}} </div>
                <div class="popUpTimer"><p id="demo"></p></div>
                <div class="popUpDueDate">{{dueDate}}</div>
            </div>
            <div class="popUpPaymentBox">
                <div class="popUpBuyIn">{{entryFee}}$ per ticket</div>
                <div class="paypal-button-container"></div>
            </div>
        </div> 
        <script>
            let dueDate = $(`.popUpDueDate`).text()
            // Set the date we're counting down to
            var countDownDate = new Date(dueDate).getTime();
            
            // Update the count down every 1 second
            var x = setInterval(function() {
            
              // Get today's date and time
              var now = new Date().getTime();
                
              // Find the distance between now and the count down date
              var distance = countDownDate - now;
                
              // Time calculations for days, hours, minutes and seconds
              var days = Math.floor(distance / (1000 * 60 * 60 * 24));
              var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
              var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
              var seconds = Math.floor((distance % (1000 * 60)) / 1000);
                
              // Output the result in an element with id="demo"
              document.getElementById("demo").innerHTML = days + "d " + hours + "h "
              + minutes + "m " + seconds + "s ";
                
              // If the count down is over, write some text 
              if (distance < 0) {
                clearInterval(x);
                document.getElementById("demo").innerHTML = "EXPIRED";
              }
            }, 1000);
            </script>
    </script>

    <script src="/handlebars/dist/handlebars.js"></script>
    <script src="/jquery/dist/jquery.js"></script>
    <script src="renderer.js"></script>
    <script src="lotteryManager.js"></script>
    <script src="main.js"></script>
</body>

</html>